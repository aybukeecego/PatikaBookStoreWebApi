using WebApi.Common;
using WebApi.DbOperations;
using Microsoft.AspNetCore.Mvc;
using System;

namespace WebApi.BookOperations.UpdateBook;

public class UpdateBookCommand
{
    public int bookId { get; set; }

    public UpdateBookModel Model { get; set; }
    private readonly BookStoreDbContext _dbcontext;
    public UpdateBookCommand(BookStoreDbContext dbContext)
    {
        _dbcontext=dbContext;
    }

    public void Handle()
    {
            var book=_dbcontext.Books.SingleOrDefault(x=> x.Id==bookId);
            if(book==null)
            throw new InvalidOperationException("Bu id'ye ait ürün bulunamamaktadır");


            book.GenreId=Model.GenreId != default? Model.GenreId : book.GenreId;
            book.PageCount=Model.PageCount != default? Model.GenreId : book.GenreId;
            book.Title=Model.Title !=default? Model.Title : book.Title;

            _dbcontext.SaveChanges();


    }

    public class UpdateBookModel
    {
        public string Title { get; set; }
        public int PageCount { get; set; }
        public int GenreId { get; set; }

    }

}